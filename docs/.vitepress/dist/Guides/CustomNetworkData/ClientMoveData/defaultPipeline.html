<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Default CharacterMovementComponent Pipeline | CMC Wiki</title>
    <meta name="description" content="In-depth guide on UE5's CMC">
    <link rel="preload stylesheet" href="/CMC-Wiki/assets/style.ced06173.css" as="style">
    
    <script type="module" src="/CMC-Wiki/assets/app.2416fe29.js"></script>
    <link rel="modulepreload" href="/CMC-Wiki/assets/chunks/framework.b8a39646.js">
    <link rel="modulepreload" href="/CMC-Wiki/assets/Guides_CustomNetworkData_ClientMoveData_defaultPipeline.md.36d3652d.lean.js">
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-79f7e488><!--[--><!--]--><!--[--><span tabindex="-1" data-v-54282c80></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-54282c80> Skip to content </a><!--]--><!----><header class="VPNav" data-v-79f7e488 data-v-ebcce517><div class="VPNavBar has-sidebar" data-v-ebcce517 data-v-48d273d6><div class="container" data-v-48d273d6><div class="title" data-v-48d273d6><div class="VPNavBarTitle has-sidebar" data-v-48d273d6 data-v-a88e9a55><a class="title" href="/CMC-Wiki/" data-v-a88e9a55><!--[--><!--]--><!----><!--[-->CMC Wiki<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-48d273d6><div class="curtain" data-v-48d273d6></div><div class="content-body" data-v-48d273d6><!--[--><!--]--><div class="VPNavBarSearch search" style="--vp-meta-key:&#39;Meta&#39;;" data-v-48d273d6><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-48d273d6 data-v-d3760206><span id="main-nav-aria-label" class="visually-hidden" data-v-d3760206>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/CMC-Wiki/" tabindex="0" data-v-d3760206 data-v-d9f3e012><!--[-->Home<!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-d3760206 data-v-57e37574><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-57e37574><span class="text" data-v-57e37574><!----> Docs <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-57e37574><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-57e37574><div class="VPMenu" data-v-57e37574 data-v-c8aee13a><div class="items" data-v-c8aee13a><!--[--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-d3760206 data-v-57e37574><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-57e37574><span class="text" data-v-57e37574><!----> Guides <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-57e37574><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-57e37574><div class="VPMenu" data-v-57e37574 data-v-c8aee13a><div class="items" data-v-c8aee13a><!--[--><!--[--><div class="VPMenuLink" data-v-c8aee13a data-v-8f74fc07><a class="VPLink link" href="/CMC-Wiki/Guides/CustomNetworkData/introduction.html" data-v-8f74fc07><!--[-->Custom Network Data<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-48d273d6 data-v-59b8183e><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-59b8183e data-v-e0ec9c81 data-v-a002e7ab><span class="check" data-v-a002e7ab><span class="icon" data-v-a002e7ab><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-e0ec9c81><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-e0ec9c81><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-48d273d6 data-v-5573cd41 data-v-88b4c202><!--[--><a class="VPSocialLink no-icon" href="https://github.com/Blueleafmonkey/CMC-Wiki" aria-label="github" target="_blank" rel="noopener" data-v-88b4c202 data-v-1898fe2a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-48d273d6 data-v-8c007a07 data-v-57e37574><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-57e37574><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-57e37574><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-57e37574><div class="VPMenu" data-v-57e37574 data-v-c8aee13a><!----><!--[--><!--[--><!----><div class="group" data-v-8c007a07><div class="item appearance" data-v-8c007a07><p class="label" data-v-8c007a07>Appearance</p><div class="appearance-action" data-v-8c007a07><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-8c007a07 data-v-e0ec9c81 data-v-a002e7ab><span class="check" data-v-a002e7ab><span class="icon" data-v-a002e7ab><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-e0ec9c81><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-e0ec9c81><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-8c007a07><div class="item social-links" data-v-8c007a07><div class="VPSocialLinks social-links-list" data-v-8c007a07 data-v-88b4c202><!--[--><a class="VPSocialLink no-icon" href="https://github.com/Blueleafmonkey/CMC-Wiki" aria-label="github" target="_blank" rel="noopener" data-v-88b4c202 data-v-1898fe2a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-48d273d6 data-v-6f1109dc><span class="container" data-v-6f1109dc><span class="top" data-v-6f1109dc></span><span class="middle" data-v-6f1109dc></span><span class="bottom" data-v-6f1109dc></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav reached-top" data-v-79f7e488 data-v-78f09a3b><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-78f09a3b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-78f09a3b><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-78f09a3b>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-78f09a3b data-v-3afc6a53><button data-v-3afc6a53>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-79f7e488 data-v-72d59148><div class="curtain" data-v-72d59148></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-72d59148><span class="visually-hidden" id="sidebar-aria-label" data-v-72d59148> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-72d59148><section class="VPSidebarItem level-0 has-active" data-v-72d59148 data-v-e0a50f13><div class="item" role="button" tabindex="0" data-v-e0a50f13><div class="indicator" data-v-e0a50f13></div><h2 class="text" data-v-e0a50f13>Guides</h2><!----></div><div class="items" data-v-e0a50f13><!--[--><section class="VPSidebarItem level-1 collapsible has-active" data-v-e0a50f13 data-v-e0a50f13><div class="item" role="button" tabindex="0" data-v-e0a50f13><div class="indicator" data-v-e0a50f13></div><h3 class="text" data-v-e0a50f13>Custom Network Data</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-e0a50f13><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-e0a50f13><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-e0a50f13><!--[--><div class="VPSidebarItem level-2 is-link" data-v-e0a50f13 data-v-e0a50f13><div class="item" data-v-e0a50f13><div class="indicator" data-v-e0a50f13></div><a class="VPLink link link" href="/CMC-Wiki/Guides/CustomNetworkData/introduction.html" data-v-e0a50f13><!--[--><p class="text" data-v-e0a50f13>Introduction</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-2 collapsible collapsed" data-v-e0a50f13 data-v-e0a50f13><div class="item" role="button" tabindex="0" data-v-e0a50f13><div class="indicator" data-v-e0a50f13></div><h4 class="text" data-v-e0a50f13>What and Why?</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-e0a50f13><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-e0a50f13><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-e0a50f13><!--[--><div class="VPSidebarItem level-3 is-link" data-v-e0a50f13 data-v-e0a50f13><div class="item" data-v-e0a50f13><div class="indicator" data-v-e0a50f13></div><a class="VPLink link link" href="/CMC-Wiki/Guides/CustomNetworkData/WhatAndWhy/what.html" data-v-e0a50f13><!--[--><p class="text" data-v-e0a50f13>What is it?</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-e0a50f13 data-v-e0a50f13><div class="item" data-v-e0a50f13><div class="indicator" data-v-e0a50f13></div><a class="VPLink link link" href="/CMC-Wiki/Guides/CustomNetworkData/WhatAndWhy/why.html" data-v-e0a50f13><!--[--><p class="text" data-v-e0a50f13>Why use it?</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible has-active" data-v-e0a50f13 data-v-e0a50f13><div class="item" role="button" tabindex="0" data-v-e0a50f13><div class="indicator" data-v-e0a50f13></div><h4 class="text" data-v-e0a50f13>Client Move Data</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-e0a50f13><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-e0a50f13><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-e0a50f13><!--[--><div class="VPSidebarItem level-3 is-link is-active has-active" data-v-e0a50f13 data-v-e0a50f13><div class="item" data-v-e0a50f13><div class="indicator" data-v-e0a50f13></div><a class="VPLink link link" href="/CMC-Wiki/Guides/CustomNetworkData/ClientMoveData/defaultPipeline.html" data-v-e0a50f13><!--[--><p class="text" data-v-e0a50f13>Default Pipeline</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-e0a50f13 data-v-e0a50f13><div class="item" data-v-e0a50f13><div class="indicator" data-v-e0a50f13></div><a class="VPLink link link" href="/CMC-Wiki/Guides/CustomNetworkData/ClientMoveData/addingCustomData.html" data-v-e0a50f13><!--[--><p class="text" data-v-e0a50f13>Adding Custom Data</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-79f7e488 data-v-6e0c0e3e><div class="VPDoc has-sidebar has-aside" data-v-6e0c0e3e data-v-cbea97f3><!--[--><!--]--><div class="container" data-v-cbea97f3><div class="aside" data-v-cbea97f3><div class="aside-curtain" data-v-cbea97f3></div><div class="aside-container" data-v-cbea97f3><div class="aside-content" data-v-cbea97f3><div class="VPDocAside" data-v-cbea97f3 data-v-ee53a92c><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-ee53a92c data-v-351a03a4><div class="content" data-v-351a03a4><div class="outline-marker" data-v-351a03a4></div><div class="outline-title" data-v-351a03a4>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-351a03a4><span class="visually-hidden" id="doc-outline-aria-label" data-v-351a03a4> Table of Contents for current page </span><ul class="root" data-v-351a03a4 data-v-a168c0e4><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-ee53a92c></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-cbea97f3><div class="content-container" data-v-cbea97f3><!--[--><!--]--><!----><main class="main" data-v-cbea97f3><div style="position:relative;" class="vp-doc _CMC-Wiki_Guides_CustomNetworkData_ClientMoveData_defaultPipeline" data-v-cbea97f3><div><h1 id="default-charactermovementcomponent-pipeline" tabindex="-1">Default CharacterMovementComponent Pipeline <a class="header-anchor" href="#default-charactermovementcomponent-pipeline" aria-label="Permalink to &quot;Default CharacterMovementComponent Pipeline&quot;">​</a></h1><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>Before adding our <strong>custom</strong> data, we need to <strong>learn</strong> a few things about how the default <a href="https://docs.unrealengine.com/5.2/en-US/API/Runtime/Engine/GameFramework/UCharacterMovementComponent" target="_blank" rel="noreferrer"><strong>CharacterMovementComponent</strong></a> works.</p><p>During the <strong>client</strong> CharacterMovementComponent&#39;s <strong>TickComponent</strong>, the function <a href="https://docs.unrealengine.com/5.2/en-US/API/Runtime/Engine/GameFramework/UCharacterMovementComponent/ReplicateMoveToS-" target="_blank" rel="noreferrer"><strong>ReplicateMoveToServer</strong></a> is called. This function does these three things in order:</p><ol><li>Creates and sets a new <a href="https://docs.unrealengine.com/5.2/en-US/API/Runtime/Engine/GameFramework/FSavedMove_Character/" target="_blank" rel="noreferrer"><strong>SavedMove</strong></a>.</li><li>Performs the move using the function, <a href="https://docs.unrealengine.com/5.2/en-US/API/Runtime/Engine/GameFramework/UCharacterMovementComponent/PerformMovement/" target="_blank" rel="noreferrer"><strong>PerformMovement</strong></a>.</li><li>Calls the function, <a href="https://docs.unrealengine.com/5.2/en-US/API/Runtime/Engine/GameFramework/UCharacterMovementComponent/CallServerMovePacked/" target="_blank" rel="noreferrer"><strong>CallServerMovePacked</strong></a>.</li></ol><p>However, this last step is not that simple. If you have watched <a href="https://www.youtube.com/watch?v=urkLwpnAjO0&amp;list=PLXJlkahwiwPmeABEhjwIALvxRSZkzoQpk" target="_blank" rel="noreferrer"><strong>Delgoodie&#39;s CMC tutorials</strong></a>, you would remember that when you added custom variables to the <a href="https://docs.unrealengine.com/5.2/en-US/API/Runtime/Engine/GameFramework/FSavedMove_Character/" target="_blank" rel="noreferrer"><strong>SavedMove</strong></a> struct, you also had to update the <a href="https://docs.unrealengine.com/5.2/en-US/API/Runtime/Engine/GameFramework/FSavedMove_Character/CanCombineWith/" target="_blank" rel="noreferrer"><strong>CanCombineWith</strong></a> function.</p><p>This function checks to see if it can <strong>combine</strong> the current NewMove with the last SavedMove (reffered to as the <strong>PendingMove</strong>). This is because the client doesn&#39;t actualy run CallServerMovePacked <strong>every</strong> frame, but it actually runs it every <strong>other</strong> frame. In the first frame, it actually just <strong>saves</strong> the SavedMove as the PendingMove, and then in the <strong>next</strong> frame it checks to see if it can <strong>combine</strong> the PendingMove with the NewMove. If it can, then it just sends one SavedMove for <strong>both</strong> frames, instead of sending two, which <strong>improves</strong> bandwidth usage.</p><div class="info custom-block"><p class="custom-block-title">NOTE</p><p>You hsould only combine moves if they have basically all the same input state data.</p></div><p>A good example of this happening is if the player was just running in a <strong>straight</strong> line. If the <strong>acceleration</strong> in both frames is pretty much the same, and the <strong>velocity</strong> also doesn&#39;t change much, then it can <strong>combine</strong> the moves and send them as one combined move to the server. The combined move uses the <strong>output</strong> state of the most <strong>recent</strong> SavedMove, but it <strong>adds</strong> the deltaTimes of both moves, so that it is effectively one big move.</p><p>However, if the client was <strong>wrong</strong>, and the moves were <strong>different</strong> (say the player pressed jump in the newest SavedMove, but wasn&#39;t in the PendingMove), then it needs to send <strong>both</strong> moves, <strong>seperately</strong>, but in the same frame.</p><p>You can see how this system works really well, as in <strong>most</strong> 60fps games, the player is <strong>usually</strong> holding down the same keys for a <strong>majority</strong> of the frames, and only <strong>changes</strong> the button states every few seconds.</p><p>But, there is actually one more move that the client will send to the server, called the <strong>OldMove</strong>. The OldMove is the oldest <strong>unacknowledged</strong> important SavedMove. Remember how the server sends back an <strong>acknowledgement</strong> for every move? Sometimes moves get <strong>dropped</strong>, arrive late, or sometimes responses from the server get dropped. To try and combat this, the client will send the <strong>oldest</strong> move that hasn&#39;t been acknowledged by the server, assuming that it was probably dropped out the <strong>first time</strong> it was sent.</p><p>So in total, in any given frame there can be up to <strong>three</strong> different moves being sent; The <strong>NewMove</strong>, <strong>PendingMove</strong>, and the <strong>OldMove</strong>. But there could also be <strong>no moves</strong> being sent, if there aren&#39;t any <strong>unacknowledged</strong> SavedMoves, and we are holding off on sending the move by putting it in the PendingMove for the <strong>next</strong> frame.</p><h2 id="inside-callservermovepacked" tabindex="-1">Inside CallServerMovePacked <a class="header-anchor" href="#inside-callservermovepacked" aria-label="Permalink to &quot;Inside CallServerMovePacked&quot;">​</a></h2><p>After learning all that, we can <strong>finally</strong> start looking inside the function, and exploring what <strong>actually happens</strong> in <a href="https://docs.unrealengine.com/5.2/en-US/API/Runtime/Engine/GameFramework/UCharacterMovementComponent/CallServerMovePacked/" target="_blank" rel="noreferrer"><strong>CallServerMovePacked</strong></a>.</p><p>Firstly, we can see that the <strong>function</strong> takes in 3 variables: <strong>NewMove</strong>, <strong>PendingMove</strong>, and <strong>OldMove</strong>, which we just learnt about in the previous section.</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">virtual</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CallServerMovePacked</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FSavedMove_Character</span><span style="color:#C792EA;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">NewMove</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FSavedMove_Character</span><span style="color:#C792EA;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">PendingMove</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FSavedMove_Character</span><span style="color:#C792EA;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">OldMove</span></span>
<span class="line"><span style="color:#89DDFF;">);</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>It is <strong>greatly encouraged</strong> for everyone to go ahead and <strong>read</strong> through this function in the source code <strong>themselves</strong>, as it is only 49 lines long, and can help with <strong>understanding</strong> it better.</p></div><h3 id="filling-the-movedatacontainer" tabindex="-1">Filling the MoveDataContainer <a class="header-anchor" href="#filling-the-movedatacontainer" aria-label="Permalink to &quot;Filling the MoveDataContainer&quot;">​</a></h3><p>Now, inside of the function we first get a <strong>reference</strong> to something called a <a href="https://docs.unrealengine.com/5.2/en-US/API/Runtime/Engine/GameFramework/FCharacterNetworkMoveDataContain-/" target="_blank" rel="noreferrer"><strong>FCharacterNetworkMoveDataContainer</strong></a>, and use the its <a href="https://docs.unrealengine.com/5.2/en-US/API/Runtime/Engine/GameFramework/FCharacterNetworkMoveDataContain-/ClientFillNetwor-/" target="_blank" rel="noreferrer"><strong>ClientFillNetworkMoveData</strong></a> method to fill it with the client data, which contains all 3 moves previously talked about.</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// Get storage container we&#39;ll be using and fill it with movement data</span></span>
<span class="line"><span style="color:#A6ACCD;">FCharacterNetworkMoveDataContainer</span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;"> MoveDataContainer </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">GetNetworkMoveDataContainer</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">MoveDataContainer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ClientFillNetworkMoveData</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">NewMove</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> PendingMove</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> OldMove</span><span style="color:#89DDFF;">);</span></span></code></pre></div><p>This <strong>FCharacterNetworkDataContainer</strong>, or <strong>MoveDataContainer</strong> for short, is a <strong>struct</strong> which contains three network moves. These <strong>network</strong> moves are not SavedMoves, but another struct called <a href="https://docs.unrealengine.com/5.2/en-US/API/Runtime/Engine/GameFramework/FCharacterNetworkMoveData/" target="_blank" rel="noreferrer"><strong>FCharacterNetworkMoveData</strong></a>, or <strong>NetworkMove</strong> for short. In <strong>ClientFillNetworkMoveData</strong>, we pass along the SavedMoves to the three NetworkMoves to fill them with data, these are then the actual network move structs which are put into the <strong>MoveDataContainer</strong>.</p><p>This can be seen here, where the NewMoveData is a NetworkMove variable.</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">NewMoveData</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">ClientFillNetworkMoveData</span><span style="color:#89DDFF;">(*</span><span style="color:#A6ACCD;">ClientNewMove</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FCharacterNetworkMoveData</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">ENetworkMoveType</span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;">NewMove</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">bDisableCombinedScopedMove </span><span style="color:#89DDFF;">|=</span><span style="color:#A6ACCD;"> ClientNewMove</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;">bForceNoCombine</span><span style="color:#89DDFF;">;</span></span></code></pre></div><details class="details custom-block"><summary>Details</summary><p>This is also <strong>repeated</strong> for the <strong>PendingMoveData</strong>, and the <strong>OldMoveData</strong>. You can see this on the <strong>highlighted</strong> lines of the function:</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FCharacterNetworkMoveDataContainer</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">ClientFillNetworkMoveData</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FSavedMove_Character</span><span style="color:#C792EA;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">ClientNewMove</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FSavedMove_Character</span><span style="color:#C792EA;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">ClientPendingMove</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FSavedMove_Character</span><span style="color:#C792EA;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">ClientOldMove</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	bDisableCombinedScopedMove </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">false;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">ensure</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ClientNewMove</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">{</span></span>
<span class="line highlighted"><span style="color:#F07178;">		</span><span style="color:#A6ACCD;">NewMoveData</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">ClientFillNetworkMoveData</span><span style="color:#89DDFF;">(*</span><span style="color:#F07178;">ClientNewMove</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">FCharacterNetworkMoveData</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">ENetworkMoveType</span><span style="color:#89DDFF;">::</span><span style="color:#F07178;">NewMove</span><span style="color:#89DDFF;">);</span></span>
<span class="line highlighted"><span style="color:#F07178;">		bDisableCombinedScopedMove </span><span style="color:#89DDFF;">|=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ClientNewMove</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;">bForceNoCombine</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	bHasPendingMove </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ClientPendingMove </span><span style="color:#89DDFF;">!=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">nullptr);</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">bHasPendingMove</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">{</span></span>
<span class="line highlighted"><span style="color:#F07178;">		</span><span style="color:#A6ACCD;">PendingMoveData</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">ClientFillNetworkMoveData</span><span style="color:#89DDFF;">(*</span><span style="color:#F07178;">ClientPendingMove</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">FCharacterNetworkMoveData</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">ENetworkMoveType</span><span style="color:#89DDFF;">::</span><span style="color:#F07178;">PendingMove</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#F07178;">		bIsDualHybridRootMotionMove </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ClientPendingMove</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;">RootMotionMontage</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">==</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">nullptr)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#F07178;">ClientNewMove </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ClientNewMove</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;">RootMotionMontage</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">nullptr);</span></span>
<span class="line highlighted"><span style="color:#F07178;">		bDisableCombinedScopedMove </span><span style="color:#89DDFF;">|=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ClientPendingMove</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;">bForceNoCombine</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;font-style:italic;">else</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">		bIsDualHybridRootMotionMove </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">false;</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span></span>
<span class="line"><span style="color:#A6ACCD;">	bHasOldMove </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ClientOldMove </span><span style="color:#89DDFF;">!=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">nullptr);</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">bHasOldMove</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">{</span></span>
<span class="line highlighted"><span style="color:#F07178;">		</span><span style="color:#A6ACCD;">OldMoveData</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">ClientFillNetworkMoveData</span><span style="color:#89DDFF;">(*</span><span style="color:#F07178;">ClientOldMove</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">FCharacterNetworkMoveData</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">ENetworkMoveType</span><span style="color:#89DDFF;">::</span><span style="color:#F07178;">OldMove</span><span style="color:#89DDFF;">);</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div></details><div class="info custom-block"><p class="custom-block-title">NOTE</p><p>It might look a little bit confusing, but the <strong>ClientFillNetworkMoveData</strong> method being called on the <strong>NewMoveData</strong> is not the same function as the <strong>ClientFillNetworkMoveData</strong> being called on the <strong>MoveDataContainer</strong>.</p></div><p>Then, in the <strong>NetworkMove</strong>&#39;s <strong>ClientFillNetworkData</strong> method, we only take the <strong>neccessary</strong> data from the SavedMove, and use it to <strong>fill</strong> the NetworkMove</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">NetworkMoveType </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> MoveType</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">TimeStamp </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ClientMove</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">TimeStamp</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">ControlRotation </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ClientMove</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">SavedControlRotation</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">CompressedMoveFlags </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ClientMove</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetCompressedFlags</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">MovementMode </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ClientMove</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">EndPackedMovementMode</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>Just as a quick <strong>summary</strong>, lets go over what we have just looked at. First, we call <strong>ClientFillNetworkMoveData</strong> on the <strong>MoveDataContainer</strong>, and pass in our <strong>NewMove</strong>, <strong>PendingMove</strong>, and <strong>OldMove</strong>. Then, it calls <strong>ClientFillNetworkData</strong> (different from the one we called on the MoveDataContainer) on each of the moves we passed in, and stores only the <strong>necessary</strong> data in the new <strong>NetworkMove</strong> variables; <strong>NewMoveData</strong>, <strong>PendingMoveData</strong>, and <strong>OldMoveData</strong>. Then those <strong>NetworkMove</strong> variables are passed into the <strong>MoveDataContainer</strong>.</p><h3 id="serialising-the-moves" tabindex="-1">Serialising the moves <a class="header-anchor" href="#serialising-the-moves" aria-label="Permalink to &quot;Serialising the moves&quot;">​</a></h3><p>Up until now we&#39;ve just been <strong>passing</strong> around the data, but now we finally have to <strong>serialize</strong> it. If you aren&#39;t familiar with serializing, it just means <strong>converting</strong> all the data to raw <strong>bits</strong>. This <strong>serialization</strong> is done for two reasons:</p><ol><li>Serializing our <strong>NetworkMove</strong> means we can <strong>optimize</strong> it and only send as <strong>few</strong> bits as possible.</li><li>We can serialize a <strong>variable</strong> number of bits, meaning you can add more bits for your <strong>custom data</strong>.</li></ol><div class="info custom-block"><p class="custom-block-title">NOTE</p><p>This was <strong>not</strong> <strong>possible</strong> until recent versions of Unreal Engine (just before Unreal Engine 5 released).</p></div><p>Now that we have a full <strong>MoveDataContainer</strong>, we can begin <strong>serializing</strong> the data. This is simply done by using the <strong>MoveDataContainer</strong>&#39;s <a href="https://docs.unrealengine.com/5.2/en-US/API/Runtime/Engine/GameFramework/FCharacterNetworkMoveDataContain-/Serialize/" target="_blank" rel="noreferrer"><strong>Serialize</strong></a> method.</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">MoveDataContainer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Serialize</span><span style="color:#89DDFF;">(*this,</span><span style="color:#A6ACCD;"> ServerMoveBitWriter</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> ServerMoveBitWriter</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">PackageMap</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>Inside of the <strong>MoveDataContainer</strong>&#39;s <strong>Serialize</strong> method, we can see that all it really does is just call the <strong>Serialize</strong> methods on our three <strong>NetworkMoves</strong>.</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(!</span><span style="color:#A6ACCD;">NewMoveData</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#82AAFF;">Serialize</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CharacterMovement</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Ar</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> PackageMap</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FCharacterNetworkMoveData</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">ENetworkMoveType</span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;">NewMove</span><span style="color:#89DDFF;">))</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">false;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>But how do we <strong>actually</strong> serialize? With an <strong>archive</strong>. An archive is a <strong>bitstream</strong> that allows you to “push” bits <strong>onto</strong> or <strong>off of</strong> it. If you haven’t seen a bitstream, don’t worry since you don’t really need to know how it <strong>works</strong>, just how to <strong>use</strong> it. In our case, the archive is <strong>ServerMoveBitWriter</strong>. So let’s see what happens when we call <strong>Serialize</strong> on our <strong>NetworkMoves</strong>.</p><div class="language-cpp"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">bool</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FCharacterNetworkMoveData</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">Serialize</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">UCharacterMovementComponent</span><span style="color:#C792EA;">&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">CharacterMovement</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FArchive</span><span style="color:#C792EA;">&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">Ar</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">UPackageMap</span><span style="color:#C792EA;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">PackageMap</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">FCharacterNetworkMoveData</span><span style="color:#89DDFF;">::</span><span style="color:#FFCB6B;">ENetworkMoveType</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">MoveType</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	NetworkMoveType </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> MoveType</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#C792EA;">bool</span><span style="color:#A6ACCD;"> bLocalSuccess </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">bool</span><span style="color:#A6ACCD;"> bIsSaving </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Ar</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">IsSaving</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	Ar </span><span style="color:#89DDFF;">&lt;&lt;</span><span style="color:#A6ACCD;"> TimeStamp</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">	// TODO: better packing with single bit per component indicating zero/non-zero</span></span>
<span class="line"><span style="color:#A6ACCD;">	Acceleration</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">NetSerialize</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Ar</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> PackageMap</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> bLocalSuccess</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	Location</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">NetSerialize</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Ar</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> PackageMap</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> bLocalSuccess</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">	// ControlRotation : FRotator handles each component zero/non-zero test; it uses a single signal bit for zero/non-zero, and uses 16 bits per component if non-zero.</span></span>
<span class="line"><span style="color:#A6ACCD;">	ControlRotation</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">NetSerialize</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Ar</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> PackageMap</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> bLocalSuccess</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#82AAFF;">SerializeOptionalValue</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">uint8</span><span style="color:#89DDFF;">&gt;(</span><span style="color:#A6ACCD;">bIsSaving</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Ar</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> CompressedMoveFlags</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#82AAFF;">SerializeOptionalValue</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">UPrimitiveComponent</span><span style="color:#89DDFF;">*&gt;(</span><span style="color:#A6ACCD;">bIsSaving</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Ar</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> MovementBase</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">nullptr);</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#82AAFF;">SerializeOptionalValue</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">FName</span><span style="color:#89DDFF;">&gt;(</span><span style="color:#A6ACCD;">bIsSaving</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Ar</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> MovementBaseBoneName</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> NAME_None</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#82AAFF;">SerializeOptionalValue</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">uint8</span><span style="color:#89DDFF;">&gt;(</span><span style="color:#A6ACCD;">bIsSaving</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Ar</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> MovementMode</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> MOVE_Walking</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">Ar</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">IsError</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>Here you can see in only a few lines all of what the CMC is sending from client to server. Pay attention to this carefully since this is where we actually control what data is being sent to the server. The Ar is the FArchive object, and we can add data to it in several showcased ways. At the top, the TimeStamp is pushed onto the archive using the &lt;&lt; operator, this just means that the entire 4 byte float is added to the bits. Then we see some helper functions on the Acceleration, Location, and ControlRotation variables which are adding themselves to the Archive under the hood. Note that the Location variable is a FVector_NetQuantized100 and the Acceleration variable is a FVector_NetQuantized10, ControlRotation is just an FRotator. We also have another helper function: SerializeOptionalValue(), which allows us to optionally serialize a value based on a bool. There is one more very helpful way to add bits to the bitstream:</p></div></div></main><footer class="VPDocFooter" data-v-cbea97f3 data-v-15af73ac><!--[--><!--]--><!----><nav class="prev-next" data-v-15af73ac><div class="pager" data-v-15af73ac><a class="pager-link prev" href="/CMC-Wiki/Guides/CustomNetworkData/WhatAndWhy/why.html" data-v-15af73ac><span class="desc" data-v-15af73ac>Previous page</span><span class="title" data-v-15af73ac>Why use it?</span></a></div><div class="pager" data-v-15af73ac><a class="pager-link next" href="/CMC-Wiki/Guides/CustomNetworkData/ClientMoveData/addingCustomData.html" data-v-15af73ac><span class="desc" data-v-15af73ac>Next page</span><span class="title" data-v-15af73ac>Adding Custom Data</span></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"guides_guides.md\":\"94862726\",\"guides_customnetworkdata_clientmovedata_addingcustomdata.md\":\"f8c55def\",\"guides_customnetworkdata_introduction.md\":\"aa8082d5\",\"guides_customnetworkdata_whatandwhy_what.md\":\"dd707980\",\"guides_customnetworkdata_whatandwhy_why.md\":\"d43e6656\",\"index.md\":\"df1423da\",\"guides_customnetworkdata_clientmovedata_defaultpipeline.md\":\"36d3652d\",\"networked-bools.md\":\"6033ea0d\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"CMC Wiki\",\"description\":\"In-depth guide on UE5's CMC\",\"base\":\"/CMC-Wiki/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Docs\",\"items\":[]},{\"text\":\"Guides\",\"items\":[{\"text\":\"Custom Network Data\",\"link\":\"/Guides/CustomNetworkData/introduction\"}]}],\"sidebar\":[{\"text\":\"Guides\",\"items\":[{\"text\":\"Custom Network Data\",\"collapsed\":true,\"items\":[{\"text\":\"Introduction\",\"link\":\"/Guides/CustomNetworkData/introduction\"},{\"text\":\"What and Why?\",\"collapsed\":true,\"items\":[{\"text\":\"What is it?\",\"link\":\"/Guides/CustomNetworkData/WhatAndWhy/what\"},{\"text\":\"Why use it?\",\"link\":\"/Guides/CustomNetworkData/WhatAndWhy/why\"}]},{\"text\":\"Client Move Data\",\"collapsed\":true,\"items\":[{\"text\":\"Default Pipeline\",\"link\":\"/Guides/CustomNetworkData/ClientMoveData/defaultPipeline\"},{\"text\":\"Adding Custom Data\",\"link\":\"/Guides/CustomNetworkData/ClientMoveData/addingCustomData\"}]}]}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/Blueleafmonkey/CMC-Wiki\"}]},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}");</script>
    
  </body>
</html>